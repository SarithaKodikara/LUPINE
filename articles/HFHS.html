<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>High-Fat High-Sugar case study â€¢ LUPINE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="High-Fat High-Sugar case study">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LUPINE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/HFHS.html">High-Fat High-Sugar case study</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav"></ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>High-Fat High-Sugar case study</h1>
                        <h4 data-toc-skip class="author">Saritha
Kodikara</h4>
            
      

      <div class="d-none name"><code>HFHS.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we explore the High-Fat High-Sugar (HFHS) case
study using the <code>LUPINE</code> R package. The aim is to demonstrate
how LUPINE can be used to analyse and visualise microbiome data from
mice on a normal diet and an HFHS diet. The focus will be on Day 7 for
both diets. We will conduct network analyses, visualise the networks,
and compare them using IVI values, network distance, and the Mantel
test. Additionally, we will examine the top 15 associations for both
diets using bootstrap-based p-values.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>First, we load the necessary libraries:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sarithakodikara.github.io/LUPINE/">LUPINE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># ggplot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span> <span class="co"># brewer.pal</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize" class="external-link">circlize</a></span><span class="op">)</span> <span class="co"># colorRamp2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span> <span class="co"># graph.adjacency</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># mutate</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span><span class="op">)</span> <span class="co"># activate</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span> <span class="co"># ggraph</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.mixOmics.org" class="external-link">mixOmics</a></span><span class="op">)</span> <span class="co"># pca</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span> <span class="co"># Heatmap</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span> <span class="co"># plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/qsbase/qs" class="external-link">qs</a></span><span class="op">)</span> <span class="co"># qread</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<p>To assess the effect of diet on the gut microbiome, 47 C57/B6 female
black mice were fed either an HFHS or a normal diet. Faecal samples were
collected on Days 0, 1, 4, and 7.</p>
<p>The raw data included 1,172 taxa across all four time points. We
removed one outlier mouse from the normal diet group due to an unusually
large library size. After filtering, we retained 102, 107, 105, and 91
taxa for the normal diet across Days 0, 1, 4, and 7, respectively. For
the HFHS diet, the numbers were 99, 147, 85, and 92 taxa, respectively.
These data are saved as <code>OTUdata_Normal</code> and
<code>OTUdata_HFHS</code> within the <code>HFHSdata</code> object.</p>
<p>We load the <code>HFHSdata</code> object, which contains OTU data,
sample information, taxonomy information, library sizes, and excluded
taxa for both the normal and HFHS diets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"HFHSdata"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="lupine-network-analysis">LUPINE network analysis<a class="anchor" aria-label="anchor" href="#lupine-network-analysis"></a>
</h2>
<p>We use <code>LUPINE</code> to infer co-occurrence networks for both
the normal and HFHS diets. The inferred networks are saved as
<code>net_Normal</code> and <code>net_HFHS</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net_Normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LUPINE.html">LUPINE</a></span><span class="op">(</span><span class="va">HFHSdata</span><span class="op">$</span><span class="va">OTUdata_Normal</span>,</span>
<span>  is.transformed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lib_size <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">Lib_Normal</span>, ncomp <span class="op">=</span> <span class="fl">1</span>, single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  excluded_taxa <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">low_Normal_taxa</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qsave.html" class="external-link">qsave</a></span><span class="op">(</span><span class="va">net_Normal</span>, <span class="st">"output/net_Normal.qs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">net_HFHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LUPINE.html">LUPINE</a></span><span class="op">(</span><span class="va">HFHSdata</span><span class="op">$</span><span class="va">OTUdata_HFHS</span>,</span>
<span>  is.transformed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lib_size <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">Lib_HFHS</span>, ncomp <span class="op">=</span> <span class="fl">1</span>, single <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  excluded_taxa <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">low_HFHS_taxa</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qsave.html" class="external-link">qsave</a></span><span class="op">(</span><span class="va">net_HFHS</span>, <span class="st">"output/net_HFHS.qs"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="network-visualization">Network visualization<a class="anchor" aria-label="anchor" href="#network-visualization"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net_Normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html" class="external-link">qread</a></span><span class="op">(</span><span class="st">"output/net_Normal.qs"</span><span class="op">)</span></span>
<span><span class="va">net_HFHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html" class="external-link">qread</a></span><span class="op">(</span><span class="st">"output/net_HFHS.qs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Day0</span> <span class="op">&lt;-</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">OTUdata_Normal</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">taxa_info</span> <span class="op">&lt;-</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">filtered_taxonomy</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Day0</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">taxa_info</span><span class="op">$</span><span class="va">X5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">taxa_info</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="va">col_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"green"</span>, <span class="st">"gray"</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>, <span class="st">"firebrick2"</span>, <span class="st">"pink"</span>,</span>
<span>    <span class="st">"tomato"</span>, <span class="st">"orange"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>, <span class="st">"hotpink"</span>, <span class="st">"lightblue"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">taxa_info</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">netPlot_HFHS</span><span class="op">(</span><span class="va">net_Normal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">col_vec</span>, <span class="st">"Normal Day7"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">netPlot_HFHS</span><span class="op">(</span><span class="va">net_HFHS</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">col_vec</span>, <span class="st">"HFHS Day7"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p><img src="HFHS_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>On Day 7, we observe fewer connections among nodes belonging to the
<em>Bacteroidales</em> order in the HFHS diet group compared to the
normal diet group. In the normal diet group, nodes from the
<em>Erysipelotrichales</em> order are more connected to those from the
<em>Bacteroidales</em> order. However, in the HFHS diet group, nodes
from <em>Erysipelotrichales</em> show more connections to those from the
<em>Lactobacillales</em> order.</p>
</div>
</div>
<div class="section level2">
<h2 id="network-comparisons">Network comparisons<a class="anchor" aria-label="anchor" href="#network-comparisons"></a>
</h2>
<p>We apply two approaches to compare the inferred networks: a network
distance measure to quantitatively evaluate the network topology and a
node-wise measure to assess the influence of individual nodes within the
network. We also conduct hypothesis tests to examine the differences
between network pairs.</p>
<div class="section level3">
<h3 id="using-network-distance">Using network distance<a class="anchor" aria-label="anchor" href="#using-network-distance"></a>
</h3>
<p>We use Graph Diffusion Distance (GDD) to measure pairwise differences
in network topologies. GDD evaluates the average similarity between two
networks by analysing information flow and connectivity through a heat
diffusion process on graphs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/distance_matrix.html">distance_matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">net_Normal</span>, <span class="va">net_HFHS</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dst</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]     [,6]</span></span>
<span><span class="co">#&gt; [1,]  0.000000  5.112057  4.589908 10.300243 11.008551 11.19028</span></span>
<span><span class="co">#&gt; [2,]  5.112057  0.000000  4.456630 10.521769 10.938152 11.12112</span></span>
<span><span class="co">#&gt; [3,]  4.589908  4.456630  0.000000 10.296871 10.444232 10.62990</span></span>
<span><span class="co">#&gt; [4,] 10.300243 10.521769 10.296871  0.000000  9.733988  9.51460</span></span>
<span><span class="co">#&gt; [5,] 11.008551 10.938152 10.444232  9.733988  0.000000  4.05905</span></span>
<span><span class="co">#&gt; [6,] 11.190284 11.121117 10.629899  9.514600  4.059050  0.00000</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span>, <span class="va">dst</span>,</span>
<span>  axes <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">""</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">600</span>, <span class="st">"YlOrRd"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%0.2f"</span>, <span class="va">dst</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cex.axis <span class="op">=</span> <span class="fl">1.2</span>, col.axis <span class="op">=</span> <span class="st">"#388ECC"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cex.axis <span class="op">=</span> <span class="fl">1.2</span>, col.axis <span class="op">=</span> <span class="st">"#F68B33"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cex.axis <span class="op">=</span> <span class="fl">1.2</span>, col.axis <span class="op">=</span> <span class="st">"#388ECC"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"D"</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cex.axis <span class="op">=</span> <span class="fl">1.2</span>, col.axis <span class="op">=</span> <span class="st">"#F68B33"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>The pairwise network distance matrix indicates that networks inferred
from the normal diet group are more similar to each other than to those
from the HFHS diet group. As the number of networks increases, so do the
pairwise distances to compare. Therefore, we employ Multidimensional
Scaling (MDS) to visualise network distances in a 2D space, allowing for
a global assessment of network similarities and differences.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html" class="external-link">cmdscale</a></span><span class="op">(</span><span class="va">dst</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"D["</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"D["</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="va">fit</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#388ECC"</span>, <span class="st">"#F68B33"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">fit</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"LUPINE"</span></span>
<span><span class="co"># Custom data frame for legend</span></span>
<span><span class="va">legend_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="st">"HFHS"</span><span class="op">)</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#388ECC"</span>, <span class="st">"#F68B33"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X1</span>, y <span class="op">=</span> <span class="va">X2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>,</span>
<span>    parse <span class="op">=</span> <span class="cn">TRUE</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"MDS2"</span>, x <span class="op">=</span> <span class="st">"MDS1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.5</span>, <span class="fl">6.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7</span>, <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">title</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># Add legend points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">legend_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1000</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, color <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span>, show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Manually set colors for the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span> <span class="op">=</span> <span class="st">"#388ECC"</span>, <span class="st">"HFHS"</span> <span class="op">=</span> <span class="st">"#F68B33"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Diet"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 id="testing-the-network-correlations-using-mantel-test">Testing the network correlations using Mantel test<a class="anchor" aria-label="anchor" href="#testing-the-network-correlations-using-mantel-test"></a>
</h3>
<p>We use the Mantel test to assess the correlation between the network
distance matrix and the pairwise distance matrix. This non-parametric
test evaluates whether two distance matrices are significantly
correlated.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mantel_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MantelTest_matrix.html">MantelTest_matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">net_Normal</span>, <span class="va">net_HFHS</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mantel_res</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,] 0.00 0.01 0.01 0.04 0.94 0.99</span></span>
<span><span class="co">#&gt; [2,] 0.01 0.00 0.01 0.04 0.69 0.94</span></span>
<span><span class="co">#&gt; [3,] 0.01 0.01 0.00 0.01 0.52 0.68</span></span>
<span><span class="co">#&gt; [4,] 0.04 0.04 0.01 0.00 0.03 0.02</span></span>
<span><span class="co">#&gt; [5,] 0.94 0.69 0.52 0.03 0.00 0.01</span></span>
<span><span class="co">#&gt; [6,] 0.99 0.94 0.68 0.02 0.01 0.00</span></span></code></pre></div>
<div class="section level4">
<h4 id="visualising-the-p-values">Visualising the p values<a class="anchor" aria-label="anchor" href="#visualising-the-p-values"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mantel_res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.0501</span>, <span class="fl">1</span>, <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">combined_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"RdPu"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="fl">51</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Blues"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">950</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">combined_ramp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="va">combined_breaks</span>, <span class="va">combined_colors</span><span class="op">)</span></span>
<span></span>
<span><span class="va">col_ha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">HeatmapAnnotation</a></span><span class="op">(</span></span>
<span>  col_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_text.html" class="external-link">anno_text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mantel_res</span><span class="op">)</span>,</span>
<span>    rot <span class="op">=</span> <span class="fl">360</span>,</span>
<span>    gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span></span>
<span>      col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#388ECC"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#F68B33"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      fontsize <span class="op">=</span> <span class="fl">14</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mantel_res</span>,</span>
<span>  col <span class="op">=</span> <span class="va">combined_ramp</span>,</span>
<span>  show_heatmap_legend <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  border <span class="op">=</span> <span class="fl">0</span>, name <span class="op">=</span> <span class="st">"p-value"</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">F</span>, cluster_columns <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  top_annotation <span class="op">=</span> <span class="va">col_ha</span>,</span>
<span>  row_names_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#388ECC"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#F68B33"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  cell_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">j</span>, <span class="va">i</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">width</span>, <span class="va">height</span>, <span class="va">fill</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid.text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">mantel_res</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span>, <span class="va">x</span>, <span class="va">y</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-12-1.png" width="480"></p>
<p>The Mantel test results indicate that networks from the normal diet
group are significantly correlated with each other and with the HFHS
diet networks on Day 1. However, the normal diet networks are not
significantly correlated with the HFHS diet networks on Days 4 and
7.</p>
</div>
</div>
<div class="section level3">
<h3 id="using-ivi-values">Using IVI values<a class="anchor" aria-label="anchor" href="#using-ivi-values"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IVI_Normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IVI_values.html">IVI_values</a></span><span class="op">(</span><span class="va">net_Normal</span>, <span class="st">"Normal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">IVI_HFHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/IVI_values.html">IVI_values</a></span><span class="op">(</span><span class="va">net_HFHS</span>, <span class="st">"HFHS"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">IVI_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">IVI_Normal</span>, <span class="va">IVI_HFHS</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qsave.html" class="external-link">qsave</a></span><span class="op">(</span><span class="va">IVI_comb</span>, <span class="st">"output/IVI_comb.qs"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IVI_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html" class="external-link">qread</a></span><span class="op">(</span><span class="st">"output/IVI_comb.qs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># matrix with only day 7 normal and HFHS IVI scores</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">IVI_comb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal_D7"</span>, <span class="st">"HFHS_D7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">col_vec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adjacency_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Taxa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">taxa_info</span><span class="op">$</span><span class="va">X1</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">as.table</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adjacency_df</span> <span class="op">&lt;-</span> <span class="va">adjacency_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  adjusted_value <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Var1</span> <span class="op">==</span> <span class="st">"Normal_D7"</span>,</span>
<span>      <span class="va">Freq</span>, <span class="op">-</span><span class="va">Freq</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure the variable column is treated as a factor (retains its original order)</span></span>
<span><span class="va">adjacency_df</span><span class="op">$</span><span class="va">Taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">adjacency_df</span><span class="op">$</span><span class="va">Taxa</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">adjacency_df</span><span class="op">$</span><span class="va">Taxa</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate y-position for annotations based on data</span></span>
<span><span class="va">annotation_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">adjacency_df</span><span class="op">$</span><span class="va">Taxa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">15</span> <span class="co"># Adjust y position</span></span>
<span></span>
<span><span class="co"># Adjust the margins in ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">adjacency_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Taxa</span>, y <span class="op">=</span> <span class="va">adjusted_value</span>, fill <span class="op">=</span> <span class="va">Var2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"stack"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">adjacency_df</span><span class="op">$</span><span class="va">Taxa</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_fill_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span> <span class="co"># Adjust margins</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"IVI"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add annotations for group labels with adjusted positions</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">annotation_y</span>, y <span class="op">=</span> <span class="fl">50</span>, label <span class="op">=</span> <span class="st">"Normal_D7"</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">1</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="st">"grey33"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">annotation_y</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">50</span>, label <span class="op">=</span> <span class="st">"HFHS_D7"</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">1</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="st">"grey33"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>The IVI analysis shows that the Day 7 network from the normal diet
group has higher IVI values in the <em>Bacteroidales</em> and
<em>Erysipelotrichales</em> orders compared to the HFHS diet network.
Conversely, the HFHS diet network on Day 7 exhibits higher IVI values
across most <em>Lactobacillales</em> nodes. We perform Principal
Component Analysis (PCA) to visualise the IVI values in a 2D space,
highlighting the strongest patterns and capturing the most variance in
the data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pca_ivi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mixOmics/man/pca.html" class="external-link">pca</a></span><span class="op">(</span><span class="va">IVI_comb</span><span class="op">[</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pca_ivi</span><span class="op">$</span><span class="va">names</span><span class="op">$</span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D[1]"</span>, <span class="st">"D[4]"</span>, <span class="st">"D[7]"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">pca_ivi</span><span class="op">$</span><span class="va">variates</span><span class="op">$</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">pca_ivi</span><span class="op">$</span><span class="va">names</span><span class="op">$</span><span class="va">sample</span><span class="op">)</span></span>
<span><span class="va">fit1</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#388ECC"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#F68B33"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit1</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"LUPINE"</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">260</span>, <span class="fl">150</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">220</span>, <span class="fl">260</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">fit1</span><span class="op">$</span><span class="va">color</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"PC1"</span>, x <span class="op">=</span> <span class="st">"PC2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">title</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add legend points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">legend_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1000</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, color <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span>, show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Manually set colors for the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span> <span class="op">=</span> <span class="st">"#388ECC"</span>, <span class="st">"HFHS"</span> <span class="op">=</span> <span class="st">"#F68B33"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Diet"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<p>The PCA plot, like the MDS plot, reveals that networks from the
normal diet group are more similar to each other than to those from the
HFHS diet group. Additionally, the normal diet networks on Day 7 are
more similar to those on Day 4 than to the HFHS diet networks on Day
7.</p>
</div>
<div class="section level3">
<h3 id="bootsrap-base-top-15-associations-for-day-7-under-normal-and-hfhs-diets">Bootsrap base top 15 associations for day 7 under normal and HFHS
diets<a class="anchor" aria-label="anchor" href="#bootsrap-base-top-15-associations-for-day-7-under-normal-and-hfhs-diets"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">netBoot_Normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LUPINE_bootsrap.html">LUPINE_bootsrap</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">OTUdata_Normal</span>, day_range <span class="op">=</span> <span class="fl">4</span>, is.transformed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lib_size <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">Lib_Normal</span>, ncomp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  single <span class="op">=</span> <span class="cn">FALSE</span>, excluded_taxa <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">low_Normal_taxa</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qsave.html" class="external-link">qsave</a></span><span class="op">(</span><span class="va">netBoot_Normal</span>, <span class="st">"output/netBoot_Normal.qs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">netBoot_HFHS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LUPINE_bootsrap.html">LUPINE_bootsrap</a></span><span class="op">(</span><span class="va">HFHSdata</span><span class="op">$</span><span class="va">OTUdata_HFHS</span>,</span>
<span>  day_range <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  is.transformed <span class="op">=</span> <span class="cn">FALSE</span>, lib_size <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">Lib_HFHS</span>, ncomp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  single <span class="op">=</span> <span class="cn">FALSE</span>, excluded_taxa <span class="op">=</span> <span class="va">HFHSdata</span><span class="op">$</span><span class="va">low_HFHS_taxa</span>, cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qsave.html" class="external-link">qsave</a></span><span class="op">(</span><span class="va">netBoot_HFHS</span>, <span class="st">"output/netBoot_HFHS.qs"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">netBoot_Normal</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html" class="external-link">qread</a></span><span class="op">(</span><span class="st">"output/netBoot_Normal.qs"</span><span class="op">)</span></span>
<span><span class="va">netBoot_HFHS</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/qs/man/qread.html" class="external-link">qread</a></span><span class="op">(</span><span class="st">"output/netBoot_HFHS.qs"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="visualising-log-pvalues-for-normal-and-hfhs-diets">Visualising log pvalues for Normal and HFHS diets<a class="anchor" aria-label="anchor" href="#visualising-log-pvalues-for-normal-and-hfhs-diets"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Normal_d7</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">taxa_o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"o__"</span>, <span class="st">""</span>, <span class="va">taxa_info</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="fu">bpvalPlot_HFHS</span><span class="op">(</span><span class="va">netBoot_Normal</span><span class="op">$</span><span class="va">Day_4</span><span class="op">$</span><span class="va">median_mt</span>, <span class="va">netBoot_Normal</span><span class="op">$</span><span class="va">Day_4</span><span class="op">$</span><span class="va">lower_mt</span>, <span class="va">netBoot_Normal</span><span class="op">$</span><span class="va">Day_4</span><span class="op">$</span><span class="va">upper_mt</span>, <span class="va">col_vec</span>, <span class="fl">15</span>, <span class="va">taxa_o</span>, <span class="st">"Normal Day7"</span><span class="op">)</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># HFHS_d7</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">taxa_o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"o__"</span>, <span class="st">""</span>, <span class="va">taxa_info</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="fu">bpvalPlot_HFHS</span><span class="op">(</span><span class="va">netBoot_HFHS</span><span class="op">$</span><span class="va">Day_4</span><span class="op">$</span><span class="va">median_mt</span>, <span class="va">netBoot_HFHS</span><span class="op">$</span><span class="va">Day_4</span><span class="op">$</span><span class="va">lower_mt</span>, <span class="va">netBoot_HFHS</span><span class="op">$</span><span class="va">Day_4</span><span class="op">$</span><span class="va">upper_mt</span>, <span class="va">col_vec</span>, <span class="fl">15</span>, <span class="va">taxa_o</span>, <span class="st">"HFHS Day7"</span><span class="op">)</span></span></code></pre></div>
<p><img src="HFHS_files/figure-html/unnamed-chunk-19-1.png" width="768"></p>
<p>The top 15 associations for the normal diet group primarily involve
nodes from the <em>Bacteroidales</em> order, while those for the HFHS
diet group mainly involve <em>Lactobacillales</em> nodes. However, both
diets exhibit a similar number of associations within
<em>Erysipelotrichales</em> nodes.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.3 (2025-02-28)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] grid      stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] qs_0.27.3             cowplot_1.1.3         patchwork_1.3.0      </span></span>
<span><span class="co">#&gt;  [4] ComplexHeatmap_2.22.0 mixOmics_6.30.0       lattice_0.22-6       </span></span>
<span><span class="co">#&gt;  [7] MASS_7.3-64           ggraph_2.2.1          tidygraph_1.3.1      </span></span>
<span><span class="co">#&gt; [10] dplyr_1.1.4           igraph_2.1.4          circlize_0.4.16      </span></span>
<span><span class="co">#&gt; [13] RColorBrewer_1.1-3    ggplot2_3.5.2         LUPINE_0.1.0         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] Rdpack_2.6.4          pbapply_1.7-2         gridExtra_2.3        </span></span>
<span><span class="co">#&gt;   [4] rlang_1.1.5           magrittr_2.0.3        clue_0.3-66          </span></span>
<span><span class="co">#&gt;   [7] GetoptLong_1.0.5      ade4_1.7-23           NetworkDistance_0.3.4</span></span>
<span><span class="co">#&gt;  [10] matrixStats_1.5.0     e1071_1.7-16          compiler_4.4.3       </span></span>
<span><span class="co">#&gt;  [13] png_0.1-8             systemfonts_1.2.2     vctrs_0.6.5          </span></span>
<span><span class="co">#&gt;  [16] reshape2_1.4.4        stringr_1.5.1         pkgconfig_2.0.3      </span></span>
<span><span class="co">#&gt;  [19] shape_1.4.6.1         crayon_1.5.3          fastmap_1.2.0        </span></span>
<span><span class="co">#&gt;  [22] labeling_0.4.3        rmarkdown_2.29        influential_2.2.9    </span></span>
<span><span class="co">#&gt;  [25] pracma_2.4.4          graphon_0.3.5         ragg_1.3.3           </span></span>
<span><span class="co">#&gt;  [28] network_1.19.0        purrr_1.0.4           xfun_0.52            </span></span>
<span><span class="co">#&gt;  [31] cachem_1.1.0          jsonlite_2.0.0        BiocParallel_1.40.2  </span></span>
<span><span class="co">#&gt;  [34] tweenr_2.0.3          cluster_2.1.8         parallel_4.4.3       </span></span>
<span><span class="co">#&gt;  [37] R6_2.6.1              bslib_0.9.0           stringi_1.8.7        </span></span>
<span><span class="co">#&gt;  [40] rlist_0.4.6.2         jquerylib_0.1.4       Rcpp_1.0.14          </span></span>
<span><span class="co">#&gt;  [43] iterators_1.0.14      knitr_1.50            ROptSpace_0.2.3      </span></span>
<span><span class="co">#&gt;  [46] IRanges_2.40.1        Matrix_1.7-2          tidyselect_1.2.1     </span></span>
<span><span class="co">#&gt;  [49] abind_1.4-8           yaml_2.3.10           viridis_0.6.5        </span></span>
<span><span class="co">#&gt;  [52] stringfish_0.16.0     doParallel_1.0.17     codetools_0.2-20     </span></span>
<span><span class="co">#&gt;  [55] tibble_3.2.1          plyr_1.8.9            withr_3.0.2          </span></span>
<span><span class="co">#&gt;  [58] rARPACK_0.11-0        coda_0.19-4.1         evaluate_1.0.3       </span></span>
<span><span class="co">#&gt;  [61] desc_1.4.3            RcppParallel_5.1.10   proxy_0.4-27         </span></span>
<span><span class="co">#&gt;  [64] polyclip_1.10-7       pillar_1.10.2         stats4_4.4.3         </span></span>
<span><span class="co">#&gt;  [67] foreach_1.5.2         ellipse_0.5.0         generics_0.1.3       </span></span>
<span><span class="co">#&gt;  [70] S4Vectors_0.44.0      munsell_0.5.1         scales_1.3.0         </span></span>
<span><span class="co">#&gt;  [73] RApiSerialize_0.1.4   class_7.3-23          glue_1.8.0           </span></span>
<span><span class="co">#&gt;  [76] tools_4.4.3           data.table_1.17.0     RSpectra_0.16-2      </span></span>
<span><span class="co">#&gt;  [79] fs_1.6.5              graphlayouts_1.2.2    tidyr_1.3.1          </span></span>
<span><span class="co">#&gt;  [82] rbibutils_2.3         colorspace_2.1-1      ggforce_0.4.2        </span></span>
<span><span class="co">#&gt;  [85] cli_3.6.4             textshaping_1.0.0     viridisLite_0.4.2    </span></span>
<span><span class="co">#&gt;  [88] corpcor_1.6.10        gtable_0.3.6          sass_0.4.9           </span></span>
<span><span class="co">#&gt;  [91] digest_0.6.37         BiocGenerics_0.52.0   ggrepel_0.9.6        </span></span>
<span><span class="co">#&gt;  [94] rjson_0.2.23          htmlwidgets_1.6.4     farver_2.1.2         </span></span>
<span><span class="co">#&gt;  [97] memoise_2.0.1         htmltools_0.5.8.1     pkgdown_2.1.1        </span></span>
<span><span class="co">#&gt; [100] lifecycle_1.0.4       GlobalOptions_0.1.2   statnet.common_4.11.0</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/SarithaKodikara" class="external-link">Saritha Kodikara</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
